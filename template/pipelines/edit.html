<!DOCTYPE html>
<html>
<head>
    <title>{{.pipeline_name|shortName}} - CICD</title>

    {{include "base_head.html" .}}

</head>
<body>

<div class="ui container maincontainer">
    
    {{include "base_menu.html" .}}

<div class="ui breadcrumb">
  <a class="section" href="{{.url|urlParentPath}}">Home</a>
  <div class="divider"> / </div>
  <a class="section" href="{{.url}}">Pipelines</a>
  <div class="divider"> / </div>
  <div class="active section">{{.pipeline_name|shortName}}</div>
</div>

<div class="ui divider"></div>

<form class="ui form" method="POST" action="{{.apiurl}}">
  {{ include "pipelines/include/main.html" .}}
  <button class="ui button" type="submit" id="pipeline_save">Submit</button>
</form>

</div>

{{include "base_foot.html" .}}

<script type="text/javascript">
    $('.ui.dropdown').dropdown();
    $.ajax({
        url: "{{ .apiurl }}",
        type: 'GET',
        dataType: 'json',
        success: function(res) {
            console.log(res.pipeline_name);
            $('#pipeline_name').val(res.pipeline_name);
            $('#agent_id').dropdown('set selected', res.agent_id);
            $('#group_id').dropdown('set selected', res.group_id);
            $('#concurrency').val(res.concurrency);
            var pipeline_jsonbody = res.body;
            var pipeline_jsonpretty = JSON.stringify(JSON.parse(pipeline_jsonbody), null, 4);
            $('#pipeline_body').val(pipeline_jsonpretty);
        }
    });

</script>


</body>
</html>
